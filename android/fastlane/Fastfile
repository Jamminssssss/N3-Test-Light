# ê¸°ë³¸ í”Œë«í¼ì„ androidë¡œ ì„¤ì •
default_platform(:android)

platform :android do
  # dotenv í”ŒëŸ¬ê·¸ì¸ì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  .env íŒŒì¼ì„ ë¡œë“œí•˜ëŠ” ì½”ë“œ ì¶”ê°€
  require 'dotenv'
  Dotenv.load('.env')  # .env íŒŒì¼ ìë™ ë¡œë“œ

  desc "ğŸš€ Internal Testìš© ì—…ë¡œë“œ"
  lane :internal do
    increment_version_code(
      gradle_file_path: "app/build.gradle"
    )

    gradle(
      task: "bundle",
      build_type: "Release"
    )

    upload_to_play_store(
      track: "internal",
      aab: "./app/build/outputs/bundle/release/app-release.aab",
      json_key: ENV["PLAY_STORE_JSON_KEY"], # â¬…ï¸ í™˜ê²½ë³€ìˆ˜ì—ì„œ í‚¤ ê²½ë¡œ ì°¸ì¡°
      skip_upload_apk: true
    )
  end

  desc "ğŸš€ Production ì—…ë¡œë“œ"
  lane :production do
    increment_version_code(
      gradle_file_path: "app/build.gradle"
    )

    gradle(
      task: "bundle",
      build_type: "Release"
    )

    upload_to_play_store(
      track: "production",
      aab: "./app/build/outputs/bundle/release/app-release.aab",
      json_key: ENV["PLAY_STORE_JSON_KEY"], # â¬…ï¸ í™˜ê²½ë³€ìˆ˜ì—ì„œ í‚¤ ê²½ë¡œ ì°¸ì¡°
      skip_upload_apk: true
    )
  end
end
